<!DOCTYPE html>
<html lang="zh-CN" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>成绩与反馈 - 智慧助教平台</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="assets/css/style.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { /* From Design Spec */ slate: { 900: '#1e293b', 800: '#2d3748', 700: '#374151', 600: '#4b5563', 100: '#f1f5f9', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 200:'#e2e8f0' }, blue: { 400: '#60a5fa', 300: '#93c5fd', 600: '#2563eb', 700: '#1d4ed8', 500: '#3b82f6' }, green: { 500: '#22c55e', 400:'#4ade80', 600: '#16a34a'}, yellow: {500: '#eab308'}, red: {500: '#ef4444'} }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-900 text-slate-100 antialiased">

    <div class="flex h-screen">
        <aside class="w-64 bg-slate-800 p-6 space-y-6 border-r border-slate-700 flex flex-col justify-between">
            <div>
                <div class="text-center mb-10">
                    <div class="inline-block p-3 bg-blue-600 rounded-full mb-2">
                        <i class="fas fa-user-graduate fa-2x text-white"></i>
                    </div>
                    <h1 class="text-xl font-semibold text-white">智慧助教平台</h1>
                    <span class="text-xs text-slate-400">学生端</span>
                </div>
                <nav class="space-y-2">
                    <a href="student_dashboard.html" class="flex items-center space-x-3 px-4 py-2.5 text-slate-300 hover:bg-slate-700 hover:text-white rounded-lg transition-colors">
                        <i class="fas fa-home fa-fw"></i>
                        <span>我的主页</span>
                    </a>
                    <a href="student_course_resources.html" class="flex items-center space-x-3 px-4 py-2.5 text-slate-300 hover:bg-slate-700 hover:text-white rounded-lg transition-colors">
                        <i class="fas fa-folder-open fa-fw"></i>
                        <span>课程资源</span>
                    </a>
                    <a href="student_assignment_submission.html" class="flex items-center space-x-3 px-4 py-2.5 text-slate-300 hover:bg-slate-700 hover:text-white rounded-lg transition-colors">
                        <i class="fas fa-file-pen fa-fw"></i>
                        <span>我的作业</span>
                    </a>
                    <a href="student_grades_feedback.html" class="flex items-center space-x-3 px-4 py-2.5 bg-blue-600 text-white rounded-lg shadow-md">
                        <i class="fas fa-clipboard-check fa-fw"></i>
                        <span>成绩与反馈</span>
                    </a>
                    <a href="#" class="flex items-center space-x-3 px-4 py-2.5 text-slate-300 hover:bg-slate-700 hover:text-white rounded-lg transition-colors">
                        <i class="fas fa-calendar-alt fa-fw"></i>
                        <span>我的课表</span>
                    </a>
                    <a href="#" class="flex items-center space-x-3 px-4 py-2.5 text-slate-300 hover:bg-slate-700 hover:text-white rounded-lg transition-colors">
                        <i class="fas fa-comments fa-fw"></i>
                        <span>课堂互动</span>
                         <span class="text-xs bg-yellow-500 text-slate-900 px-1.5 py-0.5 rounded-full">V1.1</span>
                    </a>
                </nav>
            </div>
            <div class="space-y-2 border-t border-slate-700 pt-6">
                <a href="#" class="flex items-center space-x-3 px-4 py-2.5 text-slate-300 hover:bg-slate-700 hover:text-white rounded-lg transition-colors">
                    <i class="fas fa-user-cog fa-fw"></i>
                    <span>账户设置</span>
                </a>
                <a href="login.html" class="flex items-center space-x-3 px-4 py-2.5 text-slate-300 hover:bg-red-600 hover:text-white rounded-lg transition-colors">
                    <i class="fas fa-sign-out-alt fa-fw"></i>
                    <span>退出登录</span>
                </a>
            </div>
        </aside>

        <main class="flex-1 p-6 md:p-8 overflow-y-auto bg-slate-900" id="gradesFeedbackPage">
             <header class="mb-8 flex flex-col md:flex-row justify-between md:items-center">
                <div>
                    <h2 class="text-3xl font-bold text-white">成绩与反馈</h2>
                    <p class="text-slate-400 mt-1">查看您所有已批阅作业的成绩和教师评语。</p>
                </div>
                 <div class="mt-4 md:mt-0">
                    <label for="gradesCourseSelect" class="sr-only">选择课程</label>
                    <select id="gradesCourseSelect" name="gradesCourseSelect" class="py-2 px-3 bg-slate-700 border border-slate-600 rounded-md text-slate-100 focus:ring-blue-500 focus:border-blue-500 text-sm">
                        <option value="all_courses_grades">所有课程</option>
                        <option value="soil_waste_grades" selected>土壤与固体废物监测</option>
                        <option value="air_pollution_grades">大气污染控制</option>
                    </select>
                </div>
            </header>

            <section class="mb-8 p-6 bg-slate-800 rounded-lg shadow-lg">
                <h3 class="text-xl font-semibold text-white mb-3">《土壤与固体废物监测》课程表现总览</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 text-center">
                    <div>
                        <p class="text-3xl font-bold text-green-400">88.5</p>
                        <p class="text-sm text-slate-400">平均成绩</p>
                    </div>
                    <div>
                        <p class="text-3xl font-bold text-slate-100">5 <span class="text-lg">/ 5</span></p>
                        <p class="text-sm text-slate-400">作业完成数</p>
                    </div>
                    <div>
                        <p class="text-3xl font-bold text-blue-400">A</p>
                        <p class="text-sm text-slate-400">综合评级 (预估)</p>
                    </div>
                    <div>
                         <p class="text-3xl font-bold text-slate-100">#3 <span class="text-lg">/ 30</span></p>
                        <p class="text-sm text-slate-400">班级排名 (预估)</p>
                    </div>
                </div>
            </section>

            <section id="gradedAssignmentsList" class="space-y-5">
                <div class="bg-slate-800 rounded-lg shadow-lg overflow-hidden">
                    <div class="p-5 md:p-6">
                        <div class="flex flex-col sm:flex-row justify-between sm:items-start mb-2">
                            <div>
                                <h4 class="text-lg font-semibold text-slate-100 mb-1">实验报告：土壤pH值测定</h4>
                                <p class="text-xs text-slate-400">课程：土壤与固体废物监测 | 批阅于: 2025-05-17</p>
                            </div>
                            <div class="mt-2 sm:mt-0 text-right">
                                <p class="text-2xl font-bold text-green-400">85 <span class="text-base text-slate-400">/ 100</span></p>
                                <span class="text-xs font-medium px-2 py-0.5 rounded-full bg-green-600 text-white">优秀</span>
                            </div>
                        </div>
                        <div class="mt-3 pt-3 border-t border-slate-700">
                            <p class="text-sm font-medium text-slate-300 mb-1">教师评语 (王老师):</p>
                            <p class="text-sm text-slate-200 bg-slate-700 p-3 rounded-md leading-relaxed">
                                本次实验报告完成度很高，数据记录准确，分析部分有自己的思考，图表清晰。有两点建议：1. 结论部分可以更凝练一些。2. 误差分析可以再深入探讨一下可能的环境因素。总体非常棒，继续保持！
                                <span class="block mt-1 text-xs text-blue-300">（<i class="fas fa-highlighter"></i> 作业文件中有高亮批注，请注意查看）</span>
                            </p>
                            <div class="mt-3 flex flex-wrap gap-2">
                                <button data-feedback-id="fb001" class="view-feedback-details-btn bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium py-2 px-3 rounded-md flex items-center">
                                    <i class="fas fa-eye mr-2"></i> 查看我的提交与详细反馈
                                </button>
                                <a href="#" class="bg-slate-600 hover:bg-slate-500 text-slate-200 text-sm font-medium py-2 px-3 rounded-md flex items-center" title="下载已批注的作业文件 (模拟)">
                                    <i class="fas fa-download mr-2"></i> 下载批注文件
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-800 rounded-lg shadow-lg overflow-hidden">
                     <div class="p-5 md:p-6">
                        <div class="flex flex-col sm:flex-row justify-between sm:items-start mb-2">
                            <div>
                                <h4 class="text-lg font-semibold text-slate-100 mb-1">期中随堂测验 (客观题)</h4>
                                <p class="text-xs text-slate-400">课程：土壤与固体废物监测 | 批阅于: 2025-04-20 (自动批阅)</p>
                            </div>
                            <div class="mt-2 sm:mt-0 text-right">
                                <p class="text-2xl font-bold text-yellow-400">70 <span class="text-base text-slate-400">/ 100</span></p>
                                <span class="text-xs font-medium px-2 py-0.5 rounded-full bg-yellow-600 text-white">良好</span>
                            </div>
                        </div>
                        <div class="mt-3 pt-3 border-t border-slate-700">
                            <p class="text-sm font-medium text-slate-300 mb-1">教师评语 (系统):</p>
                            <p class="text-sm text-slate-200 bg-slate-700 p-3 rounded-md leading-relaxed">
                                客观题部分得分70分。错误主要集中在“固废处理技术选择”相关题目，请重点复习该章节内容。
                            </p>
                             <div class="mt-3 flex flex-wrap gap-2">
                                <button data-feedback-id="fb002" class="view-feedback-details-btn bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium py-2 px-3 rounded-md flex items-center">
                                    <i class="fas fa-eye mr-2"></i> 查看答题卡与解析
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                </section>
            
            <div id="feedbackDetailModal" class="hidden fixed inset-0 z-50 overflow-y-auto modal-backdrop bg-slate-900 bg-opacity-75 transition-opacity items-center justify-center p-4" role="dialog">
                <div class="bg-slate-800 rounded-lg shadow-xl transform transition-all sm:max-w-3xl w-full max-h-[90vh] flex flex-col">
                    <div class="flex justify-between items-center p-4 md:p-6 border-b border-slate-700 sticky top-0 bg-slate-800 z-10">
                        <h3 id="modalFeedbackTitle" class="text-xl font-semibold text-white">实验报告：土壤pH值测定 - 反馈详情</h3>
                        <button type="button" data-modal-hide="feedbackDetailModal" class="text-slate-400 hover:text-slate-200"><i class="fas fa-times fa-lg"></i></button>
                    </div>
                    <div class="p-4 md:p-6 overflow-y-auto flex-grow">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="md:col-span-2">
                                <h4 class="text-lg font-medium text-slate-200 mb-2">我的提交预览 (带批注)</h4>
                                <div class="submission-preview bg-slate-900 border border-slate-700 rounded-md flex items-center justify-center min-h-[50vh]">
                                    <img src="https://images.unsplash.com/photo-1517842645767-c6f9040e9746?q=80&w=800&auto=format&fit=crop" alt="学生作业预览图（带批注）" class="max-w-full max-h-[50vh] object-contain rounded-md">
                                    <div class="absolute top-1/4 left-1/4 p-1 bg-yellow-400 text-black text-xs rounded shadow-lg transform -rotate-6">批注示例: 这里数据分析很棒!</div>
                                     <div class="absolute bottom-1/3 right-1/4 p-1 bg-red-300 text-black text-xs rounded shadow-lg transform rotate-3">注意: 单位错误</div>
                                </div>
                                <p class="text-xs text-slate-500 mt-2 text-center">（原型使用占位图片和模拟批注。实际系统将内嵌PDF阅读器并高亮显示教师批注。）</p>
                            </div>
                            <div class="md:col-span-1 space-y-4">
                                <div>
                                    <h4 class="text-lg font-medium text-slate-200 mb-1">最终得分</h4>
                                    <p class="text-3xl font-bold text-green-400">85 <span class="text-xl text-slate-400">/ 100</span></p>
                                </div>
                                <div>
                                    <h4 class="text-lg font-medium text-slate-200 mb-1">教师评语</h4>
                                    <p id="modalDetailedFeedback" class="text-sm text-slate-200 bg-slate-700 p-3 rounded-md leading-relaxed">
                                        本次实验报告完成度很高，数据记录准确，分析部分有自己的思考，图表清晰。有两点建议：1. 结论部分可以更凝练一些。2. 误差分析可以再深入探讨一下可能的环境因素。总体非常棒，继续保持！
                                    </p>
                                </div>
                                <div>
                                    <h4 class="text-lg font-medium text-slate-200 mb-1">反馈附件 (来自老师)</h4>
                                    <a href="#" class="flex items-center space-x-2 p-2 bg-slate-700 hover:bg-slate-600 rounded-md text-sm w-fit">
                                        <i class="far fa-file-alt text-yellow-400"></i>
                                        <span class="text-slate-200">详细评分标准.docx</span>
                                        <i class="fas fa-download text-slate-400 ml-2"></i>
                                    </a>
                                </div>
                                <div>
                                    <h4 class="text-lg font-medium text-slate-200 mb-1">我的提交</h4>
                                    <a href="#" class="flex items-center space-x-2 p-2 bg-slate-700 hover:bg-slate-600 rounded-md text-sm w-fit">
                                        <i class="far fa-file-pdf text-red-400"></i>
                                        <span class="text-slate-200">我的实验报告-李小明.pdf</span>
                                        <i class="fas fa-download text-slate-400 ml-2"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-4 md:p-6 border-t border-slate-700 sticky bottom-0 bg-slate-800 z-10">
                        <button type="button" data-modal-hide="feedbackDetailModal" class="w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md">关闭</button>
                    </div>
                </div>
            </div>


            <nav class="mt-8 flex items-center justify-between border-t border-slate-700 pt-6" aria-label="Pagination">
                <div class="hidden sm:block">
                    <p class="text-sm text-slate-400">
                        共 <span class="font-medium">3</span> 份已批阅作业
                    </p>
                </div>
                <div class="flex-1 flex justify-between sm:justify-end space-x-2">
                    <a href="#" class="relative inline-flex items-center px-3 py-2 rounded-md border border-slate-600 bg-slate-700 text-sm font-medium text-slate-300 hover:bg-slate-600 opacity-50 cursor-not-allowed">上一页</a>
                    <a href="#" class="relative inline-flex items-center px-3 py-2 rounded-md border border-slate-600 bg-slate-700 text-sm font-medium text-slate-300 hover:bg-slate-600 opacity-50 cursor-not-allowed">下一页</a>
                </div>
            </nav>

        </main>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Logic for Feedback Detail Modal
            const feedbackDetailModal = document.getElementById('feedbackDetailModal');
            const viewFeedbackDetailsBtns = document.querySelectorAll('.view-feedback-details-btn');
            const modalHideButtons = document.querySelectorAll('[data-modal-hide="feedbackDetailModal"]');

            // Mock data for feedback details (in a real app, this would be fetched)
            const feedbackDataStore = {
                "fb001": {
                    title: "实验报告：土壤pH值测定 - 反馈详情",
                    feedbackText: "本次实验报告完成度很高，数据记录准确，分析部分有自己的思考，图表清晰。有两点建议：1. 结论部分可以更凝练一些。2. 误差分析可以再深入探讨一下可能的环境因素。总体非常棒，继续保持！\n（作业文件中有高亮批注，请注意查看）",
                    // ... other data like file previews, scores etc.
                },
                 "fb002": {
                    title: "期中随堂测验 (客观题) - 反馈详情",
                    feedbackText: "客观题部分得分70分。错误主要集中在“固废处理技术选择”相关题目，请重点复习该章节内容。答题卡中已标出正确答案和您的选择。",
                }
            };

            viewFeedbackDetailsBtns.forEach(button => {
                button.addEventListener('click', () => {
                    const feedbackId = button.dataset.feedbackId;
                    const data = feedbackDataStore[feedbackId];
                    if (data && feedbackDetailModal) {
                        document.getElementById('modalFeedbackTitle').textContent = data.title;
                        document.getElementById('modalDetailedFeedback').textContent = data.feedbackText;
                        // Populate other modal parts with data if needed
                        feedbackDetailModal.classList.remove('hidden');
                        feedbackDetailModal.classList.add('flex');
                    }
                });
            });

            modalHideButtons.forEach(button => {
                button.addEventListener('click', () => {
                    if (feedbackDetailModal) {
                        feedbackDetailModal.classList.add('hidden');
                        feedbackDetailModal.classList.remove('flex');
                    }
                });
            });
             // Close modal on backdrop click
            if (feedbackDetailModal) {
                feedbackDetailModal.addEventListener('click', (event) => {
                    if (event.target === feedbackDetailModal) {
                         feedbackDetailModal.classList.add('hidden');
                         feedbackDetailModal.classList.remove('flex');
                    }
                });
            }
        });
    </script>
    <script src="assets/js/main.js"></script> </body>
</html>